<!doctype html><html lang="zh" class="no-js"><meta charset="utf-8"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="dns-prefetch" href="//fonts.googleapis.com"><link rel="dns-prefetch" href="//oi-wiki.org"><link rel="dns-prefetch" href="//search.oi-wiki.org"><link rel="dns-prefetch" href="//cdn.jsdelivr.net"><link rel="dns-prefetch" href="//api.github.com"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="description" content="OI Wiki 是一个编程竞赛知识整合站点，提供有趣又实用的编程竞赛知识以及其他有帮助的内容，帮助广大编程竞赛爱好者更快更深入地学习编程竞赛"><link rel="canonical" href="https://oi-wiki.org/misc/parallel-binsearch/"><meta name="author" content="OI Wiki Team"><meta name="lang:clipboard.copy" content="复制"><meta name="lang:clipboard.copied" content="已复制"><meta name="lang:search.language" content="jp"><meta name="lang:search.pipeline.stopwords" content="True"><meta name="lang:search.pipeline.trimmer" content="True"><meta name="lang:search.result.none" content="没有找到符合条件的结果"><meta name="lang:search.result.one" content="找到 1 个符合条件的结果"><meta name="lang:search.result.other" content="# 个符合条件的结果"><meta name="lang:search.tokenizer" content="[\uff0c\u3002]+"><link rel="shortcut icon" href="../../favicon.ico"><meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.2.0"><meta name="mobile-web-app-capable" content="yes"><link rel="icon" sizes="48x48" href="/favicon.ico"><link rel="icon" sizes="192x192" href="/favicon.ico"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="OI Wiki"><link rel="apple-touch-icon" href="/favicon.ico"><link rel="apple-touch-icon-precomposed" href="/favicon.ico"><link rel="apple-touch-startup-image" href="/favicon.ico"><meta name="msapplication-TileImage" content="/favicon.ico"><meta name="msapplication-square310x310logo" content="/favicon.ico"><link rel="icon" href="/favicon.ico" type="image/x-icon"><script>"use strict";"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then(function(e){console.log("Registration succeeded. Scope is "+e.scope)}).catch(function(e){console.log("Registration failed with "+e)})</script><title>整体二分 - OI Wiki</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ah@1.5.0/application.572ca0f0.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ah@1.5.0/application-palette.22915126.css"><meta name="theme-color" content=""><script src="https://cdn.jsdelivr.net/npm/ah@1.5.0/modernizr.1eb399a1.js" data-no-instant=""></script><link href="https://fonts.gstatic.com" rel="preconnect" crossorigin=""><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Sans:300,400,400i,700|Fira+Mono"><style>body,input{font-family:"Fira Sans","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Fira Mono","Courier New",Courier,monospace}</style><link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><link rel="manifest" href="../../manifest.webmanifest"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ah@1.5.0/han.min.css"><link rel="stylesheet" href="../../_static/css/extra.css?v=11"><style>.mjpage .MJX-monospace{font-family:monospace}.mjpage .MJX-sans-serif{font-family:sans-serif}.mjpage{display:inline;font-style:normal;font-weight:400;line-height:normal;font-size:100%;font-size-adjust:none;text-indent:0;text-align:left;text-transform:none;letter-spacing:normal;word-spacing:normal;word-wrap:normal;white-space:nowrap;float:none;direction:ltr;max-width:none;max-height:none;min-width:0;min-height:0;border:0;padding:0;margin:0}.mjpage *{transition:none;-webkit-transition:none;-moz-transition:none;-ms-transition:none;-o-transition:none}.mjx-svg-href{fill:#00f;stroke:#00f}.MathJax_SVG_LineBox{display:table!important}.MathJax_SVG_LineBox span{display:table-cell!important;width:10000em!important;min-width:0;max-width:none;padding:0;border:0;margin:0}.mjpage__block{text-align:center;margin:1em 0;position:relative;display:block!important;text-indent:0;max-width:none;max-height:none;min-width:0;min-height:0;width:100%}</style><body dir="ltr" data-md-color-primary="white" data-md-color-accent="red"><svg class="md-svg"><defs><svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z"></path></svg></defs></svg> <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off"> <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off"> <label class="md-overlay" data-md-component="overlay" for="__drawer"></label> <a href="#_1" tabindex="1" class="md-skip">跳转至</a><header class="md-header" data-md-component="header"><nav class="md-header-nav md-grid"><div class="md-flex"><div class="md-flex__cell md-flex__cell--shrink"><a href="https://oi-wiki.org" title="OI Wiki" class="md-header-nav__button md-logo"><i class="md-icon">school</i></a></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label></div><div class="md-flex__cell md-flex__cell--stretch"><div class="md-flex__ellipsis md-header-nav__title" data-md-component="title"><span class="md-header-nav__topic">OI Wiki </span><span class="md-header-nav__topic">整体二分</span></div></div><div class="md-flex__cell md-flex__cell--shrink"><label class="md-icon md-icon--search md-header-nav__button" for="__search"></label><div class="md-search" data-md-component="search" role="dialog"><label class="md-search__overlay" for="__search"></label><div class="md-search__inner" role="search"><form class="md-search__form" name="search"><input class="md-search__input" name="query" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active"> <label class="md-icon md-search__icon" for="__search"></label> <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1"></button></form><div class="md-search__output"><div class="md-search__scrollwrap" data-md-scrollfix=""><div class="md-search-result" data-md-component="result"><div class="md-search-result__meta">键入以开始搜索</div><ol class="md-search-result__list"></ol></div></div></div></div></div></div><div class="md-flex__cell md-flex__cell--shrink"><div class="md-header-nav__source"><a href="https://github.com/24OI/OI-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">24OI/OI-wiki</div></a></div></div></div></nav></header><div class="md-container"><nav class="md-tabs md-tabs--active" data-md-component="tabs"><div class="md-tabs__inner md-grid"><ul class="md-tabs__list"><li class="md-tabs__item"><a href="../.." title="简介" class="md-tabs__link">简介</a><li class="md-tabs__item"><a href="../../basic/" title="基础部分" class="md-tabs__link">基础部分</a><li class="md-tabs__item"><a href="../../search/" title="搜索" class="md-tabs__link">搜索</a><li class="md-tabs__item"><a href="../../dp/" title="动态规划" class="md-tabs__link">动态规划</a><li class="md-tabs__item"><a href="../../string/" title="字符串" class="md-tabs__link">字符串</a><li class="md-tabs__item"><a href="../../math/" title="数学" class="md-tabs__link">数学</a><li class="md-tabs__item"><a href="../../ds/" title="数据结构" class="md-tabs__link">数据结构</a><li class="md-tabs__item"><a href="../../graph/" title="图论" class="md-tabs__link">图论</a><li class="md-tabs__item"><a href="../../geometry/" title="计算几何" class="md-tabs__link">计算几何</a><li class="md-tabs__item"><a href="../" title="杂项" class="md-tabs__link md-tabs__link--active">杂项</a></ul></div></nav><main class="md-main"><div class="md-main__inner md-grid" data-md-component="container"><div class="md-sidebar md-sidebar--primary" data-md-component="navigation"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--primary" data-md-level="0"><label class="md-nav__title md-nav__title--site" for="__drawer"><a href="https://oi-wiki.org" title="OI Wiki" class="md-nav__button md-logo"><i class="md-icon">school</i> </a>OI Wiki</label><div class="md-nav__source"><a href="https://github.com/24OI/OI-wiki/" title="前往 Github 仓库" class="md-source" data-md-source="github"><div class="md-source__icon"><svg viewBox="0 0 24 24" width="24" height="24"><use xlink:href="#__github" width="24" height="24"></use></svg></div><div class="md-source__repository">24OI/OI-wiki</div></a></div><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-1" type="checkbox" id="nav-1"> <label class="md-nav__link" for="nav-1">简介</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-1">简介</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../.." title="Getting Started" class="md-nav__link">Getting Started</a><li class="md-nav__item"><a href="../../intro/mode/" title="OI 赛事与赛制" class="md-nav__link">OI 赛事与赛制</a><li class="md-nav__item"><a href="../../intro/icpc/" title="ICPC/CCPC 赛事与赛制" class="md-nav__link">ICPC/CCPC 赛事与赛制</a><li class="md-nav__item"><a href="../../intro/resources/" title="学习资源" class="md-nav__link">学习资源</a><li class="md-nav__item"><a href="../../intro/common-mistakes/" title="常见错误" class="md-nav__link">常见错误</a><li class="md-nav__item"><a href="../../intro/common-tricks/" title="常见技巧" class="md-nav__link">常见技巧</a><li class="md-nav__item"><a href="../../intro/non-traditional/" title="非传统题" class="md-nav__link">非传统题</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-8" type="checkbox" id="nav-1-8"> <label class="md-nav__link" for="nav-1-8">工具软件</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-1-8">工具软件</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../intro/judgers/" title="评测工具" class="md-nav__link">评测工具</a><li class="md-nav__item"><a href="../../intro/editors/" title="编辑工具" class="md-nav__link">编辑工具</a><li class="md-nav__item"><a href="../../intro/wsl/" title="WSL (Windows 10)" class="md-nav__link">WSL (Windows 10)</a><li class="md-nav__item"><a href="../../intro/spj/" title="Special Judge" class="md-nav__link">Special Judge</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-1-8-5" type="checkbox" id="nav-1-8-5"> <label class="md-nav__link" for="nav-1-8-5">Testlib</label><nav class="md-nav" data-md-component="collapsible" data-md-level="3"><label class="md-nav__title" for="nav-1-8-5">Testlib</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../intro/testlib/" title="Testlib 简介" class="md-nav__link">Testlib 简介</a><li class="md-nav__item"><a href="../../intro/testlib/general/" title="通用" class="md-nav__link">通用</a><li class="md-nav__item"><a href="../../intro/testlib/generator/" title="Generator" class="md-nav__link">Generator</a><li class="md-nav__item"><a href="../../intro/testlib/validator/" title="Validator" class="md-nav__link">Validator</a><li class="md-nav__item"><a href="../../intro/testlib/interactor/" title="Interactor" class="md-nav__link">Interactor</a><li class="md-nav__item"><a href="../../intro/testlib/checker/" title="Checker" class="md-nav__link">Checker</a></ul></nav></ul></nav><li class="md-nav__item"><a href="../../intro/docker-deploy/" title="Docker 部署" class="md-nav__link">Docker 部署</a><li class="md-nav__item"><a href="../../intro/about/" title="关于本项目" class="md-nav__link">关于本项目</a><li class="md-nav__item"><a href="../../intro/faq/" title="F.A.Q." class="md-nav__link">F.A.Q.</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2"> <label class="md-nav__link" for="nav-2">基础部分</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-2">基础部分</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../basic/" title="基础部分简介" class="md-nav__link">基础部分简介</a><li class="md-nav__item"><a href="../../basic/enumerate/" title="枚举" class="md-nav__link">枚举</a><li class="md-nav__item"><a href="../../basic/simulate/" title="模拟" class="md-nav__link">模拟</a><li class="md-nav__item"><a href="../../basic/divide-and-conquer/" title="递归 &amp; 分治" class="md-nav__link">递归 &amp; 分治</a><li class="md-nav__item"><a href="../../basic/greedy/" title="贪心" class="md-nav__link">贪心</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-2-6" type="checkbox" id="nav-2-6"> <label class="md-nav__link" for="nav-2-6">排序</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-2-6">排序</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../basic/sort-intro/" title="排序简介" class="md-nav__link">排序简介</a><li class="md-nav__item"><a href="../../basic/selection-sort/" title="选择排序" class="md-nav__link">选择排序</a><li class="md-nav__item"><a href="../../basic/bubble-sort/" title="冒泡排序" class="md-nav__link">冒泡排序</a><li class="md-nav__item"><a href="../../basic/insertion-sort/" title="插入排序" class="md-nav__link">插入排序</a><li class="md-nav__item"><a href="../../basic/bucket-sort/" title="计数排序" class="md-nav__link">计数排序</a><li class="md-nav__item"><a href="../../basic/quick-sort/" title="快速排序" class="md-nav__link">快速排序</a><li class="md-nav__item"><a href="../../basic/merge-sort/" title="归并排序" class="md-nav__link">归并排序</a><li class="md-nav__item"><a href="../../basic/heap-sort/" title="堆排序" class="md-nav__link">堆排序</a><li class="md-nav__item"><a href="../../basic/radix-sort/" title="基数排序" class="md-nav__link">基数排序</a><li class="md-nav__item"><a href="../../basic/shell-sort/" title="希尔排序" class="md-nav__link">希尔排序</a><li class="md-nav__item"><a href="../../basic/stl-sort/" title="排序相关 STL" class="md-nav__link">排序相关 STL</a><li class="md-nav__item"><a href="../../basic/use-of-sort/" title="排序应用" class="md-nav__link">排序应用</a></ul></nav><li class="md-nav__item"><a href="../../basic/expression/" title="表达式求值" class="md-nav__link">表达式求值</a><li class="md-nav__item"><a href="../../basic/binary/" title="二分" class="md-nav__link">二分</a><li class="md-nav__item"><a href="../../basic/construction/" title="构造" class="md-nav__link">构造</a><li class="md-nav__item"><a href="../../basic/prefix-sum/" title="前缀和 &amp; 差分" class="md-nav__link">前缀和 &amp; 差分</a><li class="md-nav__item"><a href="../../basic/file-operation/" title="文件操作" class="md-nav__link">文件操作</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3"> <label class="md-nav__link" for="nav-3">搜索</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-3">搜索</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../search/" title="搜索部分简介" class="md-nav__link">搜索部分简介</a><li class="md-nav__item"><a href="../../search/dfs/" title="DFS" class="md-nav__link">DFS</a><li class="md-nav__item"><a href="../../search/bfs/" title="BFS" class="md-nav__link">BFS</a><li class="md-nav__item"><a href="../../search/bidirectional/" title="双向搜索" class="md-nav__link">双向搜索</a><li class="md-nav__item"><a href="../../search/heuristic/" title="启发式搜索" class="md-nav__link">启发式搜索</a><li class="md-nav__item"><a href="../../search/astar/" title="A*" class="md-nav__link">A*</a><li class="md-nav__item"><a href="../../search/iterative/" title="迭代加深搜索" class="md-nav__link">迭代加深搜索</a><li class="md-nav__item"><a href="../../search/idastar/" title="IDA*" class="md-nav__link">IDA*</a><li class="md-nav__item"><a href="../../search/backtracking/" title="回溯法" class="md-nav__link">回溯法</a><li class="md-nav__item"><a href="../../search/dlx/" title="Dancing Links" class="md-nav__link">Dancing Links</a><li class="md-nav__item"><a href="../../search/optimization/" title="优化" class="md-nav__link">优化</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4"> <label class="md-nav__link" for="nav-4">动态规划</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-4">动态规划</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../dp/" title="动态规划部分简介" class="md-nav__link">动态规划部分简介</a><li class="md-nav__item"><a href="../../dp/memo/" title="记忆化搜索" class="md-nav__link">记忆化搜索</a><li class="md-nav__item"><a href="../../dp/knapsack/" title="背包 DP" class="md-nav__link">背包 DP</a><li class="md-nav__item"><a href="../../dp/interval/" title="区间 DP" class="md-nav__link">区间 DP</a><li class="md-nav__item"><a href="../../dp/dag/" title="DAG 上的 DP" class="md-nav__link">DAG 上的 DP</a><li class="md-nav__item"><a href="../../dp/tree/" title="树形 DP" class="md-nav__link">树形 DP</a><li class="md-nav__item"><a href="../../dp/state/" title="状压 DP" class="md-nav__link">状压 DP</a><li class="md-nav__item"><a href="../../dp/number/" title="数位 DP" class="md-nav__link">数位 DP</a><li class="md-nav__item"><a href="../../dp/plug/" title="插头 DP" class="md-nav__link">插头 DP</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10"> <label class="md-nav__link" for="nav-4-10">DP 优化</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-4-10">DP 优化</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../dp/optimizations/binary-knapsack/" title="二进制分组解多重背包" class="md-nav__link">二进制分组解多重背包</a><li class="md-nav__item"><a href="../../dp/optimizations/monotonous-queue-stack/" title="单调队列/单调栈优化" class="md-nav__link">单调队列/单调栈优化</a><li class="md-nav__item"><a href="../../dp/optimizations/convex-hull-optimization/" title="斜率优化" class="md-nav__link">斜率优化</a><li class="md-nav__item"><a href="../../dp/optimizations/knuth-yao-quadrangle-inequality/" title="四边形不等式优化" class="md-nav__link">四边形不等式优化</a><li class="md-nav__item"><a href="../../dp/optimizations/state-optimization/" title="状态设计优化" class="md-nav__link">状态设计优化</a></ul></nav><li class="md-nav__item"><a href="../../dp/misc/" title="其它 DP 方法" class="md-nav__link">其它 DP 方法</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5"> <label class="md-nav__link" for="nav-5">字符串</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-5">字符串</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../string/" title="字符串部分简介" class="md-nav__link">字符串部分简介</a><li class="md-nav__item"><a href="../../string/lib-func/" title="标准库" class="md-nav__link">标准库</a><li class="md-nav__item"><a href="../../string/match/" title="字符串匹配" class="md-nav__link">字符串匹配</a><li class="md-nav__item"><a href="../../string/hash/" title="哈希" class="md-nav__link">哈希</a><li class="md-nav__item"><a href="../../string/prefix-function/" title="前缀函数与 KMP 算法" class="md-nav__link">前缀函数与 KMP 算法</a><li class="md-nav__item"><a href="../../string/trie/" title="字典树 (Trie)" class="md-nav__link">字典树 (Trie)</a><li class="md-nav__item"><a href="../../string/pam/" title="回文自动机" class="md-nav__link">回文自动机</a><li class="md-nav__item"><a href="../../string/sa/" title="后缀数组 (SA)" class="md-nav__link">后缀数组 (SA)</a><li class="md-nav__item"><a href="../../string/ac-automaton/" title="AC 自动机" class="md-nav__link">AC 自动机</a><li class="md-nav__item"><a href="../../string/sam/" title="后缀自动机 (SAM)" class="md-nav__link">后缀自动机 (SAM)</a><li class="md-nav__item"><a href="../../string/suffix-tree/" title="后缀树" class="md-nav__link">后缀树</a><li class="md-nav__item"><a href="../../string/manacher/" title="Manacher" class="md-nav__link">Manacher</a><li class="md-nav__item"><a href="../../string/minimal-string/" title="最小表示法" class="md-nav__link">最小表示法</a><li class="md-nav__item"><a href="../../string/z-function/" title="Z 函数（扩展 KMP）" class="md-nav__link">Z 函数（扩展 KMP）</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6"> <label class="md-nav__link" for="nav-6">数学</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-6">数学</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../math/" title="数学部分简介" class="md-nav__link">数学部分简介</a><li class="md-nav__item"><a href="../../math/base/" title="进制" class="md-nav__link">进制</a><li class="md-nav__item"><a href="../../math/bit/" title="位运算" class="md-nav__link">位运算</a><li class="md-nav__item"><a href="../../math/bignum/" title="高精度" class="md-nav__link">高精度</a><li class="md-nav__item"><a href="../../math/quick-pow/" title="快速幂" class="md-nav__link">快速幂</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-6" type="checkbox" id="nav-6-6"> <label class="md-nav__link" for="nav-6-6">整除及其性质</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-6-6">整除及其性质</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../math/prime/" title="素数" class="md-nav__link">素数</a><li class="md-nav__item"><a href="../../math/gcd/" title="最大公约数" class="md-nav__link">最大公约数</a><li class="md-nav__item"><a href="../../math/euler/" title="欧拉函数" class="md-nav__link">欧拉函数</a><li class="md-nav__item"><a href="../../math/sieve/" title="筛法" class="md-nav__link">筛法</a><li class="md-nav__item"><a href="../../math/fermat/" title="费马小定理" class="md-nav__link">费马小定理</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-7" type="checkbox" id="nav-6-7"> <label class="md-nav__link" for="nav-6-7">同余方程相关</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-6-7">同余方程相关</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../math/bezouts/" title="裴蜀定理" class="md-nav__link">裴蜀定理</a><li class="md-nav__item"><a href="../../math/inverse/" title="乘法逆元" class="md-nav__link">乘法逆元</a><li class="md-nav__item"><a href="../../math/linear-equation/" title="线性同余方程" class="md-nav__link">线性同余方程</a><li class="md-nav__item"><a href="../../math/crt/" title="中国剩余定理" class="md-nav__link">中国剩余定理</a><li class="md-nav__item"><a href="../../math/bsgs/" title="BSGS" class="md-nav__link">BSGS</a><li class="md-nav__item"><a href="../../math/primitive-root/" title="原根" class="md-nav__link">原根</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-8" type="checkbox" id="nav-6-8"> <label class="md-nav__link" for="nav-6-8">线性代数</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-6-8">线性代数</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../math/matrix/" title="矩阵" class="md-nav__link">矩阵</a><li class="md-nav__item"><a href="../../math/gauss/" title="高斯消元" class="md-nav__link">高斯消元</a><li class="md-nav__item"><a href="../../math/basis/" title="线性基" class="md-nav__link">线性基</a></ul></nav><li class="md-nav__item"><a href="../../math/complex/" title="复数" class="md-nav__link">复数</a><li class="md-nav__item"><a href="../../math/dictionary/" title="分段打表" class="md-nav__link">分段打表</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-11" type="checkbox" id="nav-6-11"> <label class="md-nav__link" for="nav-6-11">数论函数相关</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-6-11">数论函数相关</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../math/mobius/" title="莫比乌斯反演" class="md-nav__link">莫比乌斯反演</a><li class="md-nav__item"><a href="../../math/du-sieves/" title="杜教筛" class="md-nav__link">杜教筛</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-12" type="checkbox" id="nav-6-12"> <label class="md-nav__link" for="nav-6-12">多项式</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-6-12">多项式</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../math/poly/intro/" title="多项式部分简介" class="md-nav__link">多项式部分简介</a><li class="md-nav__item"><a href="../../math/poly/lagrange-poly/" title="拉格朗日插值" class="md-nav__link">拉格朗日插值</a><li class="md-nav__item"><a href="../../math/poly/fft/" title="快速傅里叶变换" class="md-nav__link">快速傅里叶变换</a><li class="md-nav__item"><a href="../../math/poly/ntt/" title="快速数论变换" class="md-nav__link">快速数论变换</a><li class="md-nav__item"><a href="../../math/poly/fwt/" title="快速沃尔什变换" class="md-nav__link">快速沃尔什变换</a><li class="md-nav__item"><a href="../../math/poly/inv/" title="多项式求逆" class="md-nav__link">多项式求逆</a><li class="md-nav__item"><a href="../../math/poly/sqrt/" title="多项式开方" class="md-nav__link">多项式开方</a><li class="md-nav__item"><a href="../../math/poly/div-mod/" title="多项式除法|取模" class="md-nav__link">多项式除法|取模</a><li class="md-nav__item"><a href="../../math/poly/ln-exp/" title="多项式对数函数|指数函数" class="md-nav__link">多项式对数函数|指数函数</a><li class="md-nav__item"><a href="../../math/poly/newton/" title="多项式牛顿迭代" class="md-nav__link">多项式牛顿迭代</a><li class="md-nav__item"><a href="../../math/poly/multipoint-eval-interpolation/" title="多项式多点求值|快速插值" class="md-nav__link">多项式多点求值|快速插值</a><li class="md-nav__item"><a href="../../math/poly/tri-func/" title="多项式三角函数" class="md-nav__link">多项式三角函数</a><li class="md-nav__item"><a href="../../math/poly/inv-tri-func/" title="多项式反三角函数" class="md-nav__link">多项式反三角函数</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-13" type="checkbox" id="nav-6-13"> <label class="md-nav__link" for="nav-6-13">组合数学</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-6-13">组合数学</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../math/combination/" title="排列组合" class="md-nav__link">排列组合</a><li class="md-nav__item"><a href="../../math/catalan/" title="卡特兰数" class="md-nav__link">卡特兰数</a><li class="md-nav__item"><a href="../../math/stirling/" title="斯特林数" class="md-nav__link">斯特林数</a><li class="md-nav__item"><a href="../../math/cantor/" title="康托展开" class="md-nav__link">康托展开</a><li class="md-nav__item"><a href="../../math/inclusion-exclusion-principle/" title="容斥原理" class="md-nav__link">容斥原理</a><li class="md-nav__item"><a href="../../math/drawer-principle/" title="抽屉原理" class="md-nav__link">抽屉原理</a></ul></nav><li class="md-nav__item"><a href="../../math/expectation/" title="概率 &amp; 期望" class="md-nav__link">概率 &amp; 期望</a><li class="md-nav__item"><a href="../../math/permutation-group/" title="置换群" class="md-nav__link">置换群</a><li class="md-nav__item"><a href="../../math/integral/" title="数值积分" class="md-nav__link">数值积分</a><li class="md-nav__item"><a href="../../math/linear-programming/" title="线性规划" class="md-nav__link">线性规划</a><li class="md-nav__item"><a href="../../math/game-theory/" title="博弈论" class="md-nav__link">博弈论</a><li class="md-nav__item"><a href="../../math/misc/" title="杂项" class="md-nav__link">杂项</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7"> <label class="md-nav__link" for="nav-7">数据结构</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-7">数据结构</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../ds/" title="数据结构部分简介" class="md-nav__link">数据结构部分简介</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2"> <label class="md-nav__link" for="nav-7-2">STL</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-7-2">STL</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../ds/stl/" title="STL 简介" class="md-nav__link">STL 简介</a><li class="md-nav__item"><a href="../../ds/stl/vector/" title="vector" class="md-nav__link">vector</a><li class="md-nav__item"><a href="../../ds/stl/priority_queue/" title="priority_queue" class="md-nav__link">priority_queue</a><li class="md-nav__item"><a href="../../ds/stl/map/" title="map" class="md-nav__link">map</a><li class="md-nav__item"><a href="../../ds/stl/bitset/" title="bitset" class="md-nav__link">bitset</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3"> <label class="md-nav__link" for="nav-7-3">pb_ds</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-7-3">pb_ds</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../ds/pb-ds/" title="pb_ds 简介" class="md-nav__link">pb_ds 简介</a><li class="md-nav__item"><a href="../../ds/pb-ds/priority-queue/" title="__gnu_pbds::priority_queue" class="md-nav__link">__gnu_pbds::priority_queue</a></ul></nav><li class="md-nav__item"><a href="../../ds/stack/" title="栈" class="md-nav__link">栈</a><li class="md-nav__item"><a href="../../ds/queue/" title="队列" class="md-nav__link">队列</a><li class="md-nav__item"><a href="../../ds/linked-list/" title="链表" class="md-nav__link">链表</a><li class="md-nav__item"><a href="../../ds/hash/" title="哈希表" class="md-nav__link">哈希表</a><li class="md-nav__item"><a href="../../ds/dsu/" title="并查集" class="md-nav__link">并查集</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-9" type="checkbox" id="nav-7-9"> <label class="md-nav__link" for="nav-7-9">堆</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-7-9">堆</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../ds/heap/" title="堆简介" class="md-nav__link">堆简介</a><li class="md-nav__item"><a href="../../ds/binary-heap/" title="二叉堆" class="md-nav__link">二叉堆</a><li class="md-nav__item"><a href="../../ds/pairing-heap/" title="配对堆" class="md-nav__link">配对堆</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-10" type="checkbox" id="nav-7-10"> <label class="md-nav__link" for="nav-7-10">块状数据结构</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-7-10">块状数据结构</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../ds/square-root-decomposition/" title="分块思想" class="md-nav__link">分块思想</a><li class="md-nav__item"><a href="../../ds/block-list/" title="块状链表" class="md-nav__link">块状链表</a><li class="md-nav__item"><a href="../../ds/block-array/" title="块状数组" class="md-nav__link">块状数组</a><li class="md-nav__item"><a href="../../ds/tree-decompose/" title="树分块" class="md-nav__link">树分块</a></ul></nav><li class="md-nav__item"><a href="../../ds/monotonous-stack/" title="单调栈" class="md-nav__link">单调栈</a><li class="md-nav__item"><a href="../../ds/monotonous-queue/" title="单调队列" class="md-nav__link">单调队列</a><li class="md-nav__item"><a href="../../ds/sparse-table/" title="倍增" class="md-nav__link">倍增</a><li class="md-nav__item"><a href="../../ds/bit/" title="树状数组" class="md-nav__link">树状数组</a><li class="md-nav__item"><a href="../../ds/segment/" title="线段树" class="md-nav__link">线段树</a><li class="md-nav__item"><a href="../../ds/dividing/" title="划分树" class="md-nav__link">划分树</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-17" type="checkbox" id="nav-7-17"> <label class="md-nav__link" for="nav-7-17">平衡树</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-7-17">平衡树</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../ds/bst/" title="二叉搜索树简介" class="md-nav__link">二叉搜索树简介</a><li class="md-nav__item"><a href="../../ds/treap/" title="Treap" class="md-nav__link">Treap</a><li class="md-nav__item"><a href="../../ds/splay/" title="Splay" class="md-nav__link">Splay</a><li class="md-nav__item"><a href="../../ds/wblt/" title="WBLT" class="md-nav__link">WBLT</a><li class="md-nav__item"><a href="../../ds/sbt/" title="Size Balanced Tree" class="md-nav__link">Size Balanced Tree</a><li class="md-nav__item"><a href="../../ds/avl/" title="AVL 树" class="md-nav__link">AVL 树</a><li class="md-nav__item"><a href="../../ds/scapegoat/" title="替罪羊树" class="md-nav__link">替罪羊树</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-18" type="checkbox" id="nav-7-18"> <label class="md-nav__link" for="nav-7-18">树套树</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-7-18">树套树</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../ds/seg-in-seg/" title="线段树套线段树" class="md-nav__link">线段树套线段树</a><li class="md-nav__item"><a href="../../ds/seg-in-balanced/" title="平衡树套线段树" class="md-nav__link">平衡树套线段树</a><li class="md-nav__item"><a href="../../ds/balanced-in-seg/" title="线段树套平衡树" class="md-nav__link">线段树套平衡树</a><li class="md-nav__item"><a href="../../ds/persistent-in-bit/" title="树状数组套主席树" class="md-nav__link">树状数组套主席树</a></ul></nav><li class="md-nav__item"><a href="../../ds/k-dtree/" title="K-Dtree" class="md-nav__link">K-Dtree</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-20" type="checkbox" id="nav-7-20"> <label class="md-nav__link" for="nav-7-20">可持久化数据结构</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-7-20">可持久化数据结构</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../ds/persistent/" title="可持久化数据结构简介" class="md-nav__link">可持久化数据结构简介</a><li class="md-nav__item"><a href="../../ds/persistent-seg/" title="可持久化线段树" class="md-nav__link">可持久化线段树</a><li class="md-nav__item"><a href="../../ds/persistent-block-array/" title="可持久化块状数组" class="md-nav__link">可持久化块状数组</a><li class="md-nav__item"><a href="../../ds/persistent-balanced/" title="可持久化平衡树" class="md-nav__link">可持久化平衡树</a><li class="md-nav__item"><a href="../../ds/persistent-trie/" title="可持久化字典树" class="md-nav__link">可持久化字典树</a></ul></nav><li class="md-nav__item"><a href="../../ds/odt/" title="珂朵莉树" class="md-nav__link">珂朵莉树</a><li class="md-nav__item"><a href="../../ds/lct/" title="Link Cut Tree" class="md-nav__link">Link Cut Tree</a><li class="md-nav__item"><a href="../../ds/ett/" title="Euler Tour Tree" class="md-nav__link">Euler Tour Tree</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8"> <label class="md-nav__link" for="nav-8">图论</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-8">图论</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../graph/" title="图论部分简介" class="md-nav__link">图论部分简介</a><li class="md-nav__item"><a href="../../graph/basic/" title="图论基础" class="md-nav__link">图论基础</a><li class="md-nav__item"><a href="../../graph/traverse/" title="图的遍历" class="md-nav__link">图的遍历</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-4" type="checkbox" id="nav-8-4"> <label class="md-nav__link" for="nav-8-4">树上问题</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-8-4">树上问题</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../graph/tree-basic/" title="树基础" class="md-nav__link">树基础</a><li class="md-nav__item"><a href="../../graph/lca/" title="最近公共祖先" class="md-nav__link">最近公共祖先</a><li class="md-nav__item"><a href="../../graph/dfs-order/" title="DFS 序" class="md-nav__link">DFS 序</a><li class="md-nav__item"><a href="../../graph/tree-misc/" title="树的其他问题" class="md-nav__link">树的其他问题</a><li class="md-nav__item"><a href="../../graph/tree-hash/" title="树哈希" class="md-nav__link">树哈希</a><li class="md-nav__item"><a href="../../graph/heavy-light-decomposition/" title="树链剖分" class="md-nav__link">树链剖分</a><li class="md-nav__item"><a href="../../graph/tree-divide/" title="树分治" class="md-nav__link">树分治</a><li class="md-nav__item"><a href="../../graph/dynamic-tree-divide/" title="动态树分治" class="md-nav__link">动态树分治</a><li class="md-nav__item"><a href="../../graph/virtual-tree/" title="虚树" class="md-nav__link">虚树</a><li class="md-nav__item"><a href="../../graph/dsu-on-tree/" title="树上启发式合并" class="md-nav__link">树上启发式合并</a></ul></nav><li class="md-nav__item"><a href="../../graph/matrix-tree/" title="矩阵树定理" class="md-nav__link">矩阵树定理</a><li class="md-nav__item"><a href="../../graph/dag/" title="有向无环图" class="md-nav__link">有向无环图</a><li class="md-nav__item"><a href="../../graph/topo/" title="拓扑排序" class="md-nav__link">拓扑排序</a><li class="md-nav__item"><a href="../../graph/mst/" title="最小生成树" class="md-nav__link">最小生成树</a><li class="md-nav__item"><a href="../../graph/mdst/" title="最小树形图" class="md-nav__link">最小树形图</a><li class="md-nav__item"><a href="../../graph/shortest-path/" title="最短路" class="md-nav__link">最短路</a><li class="md-nav__item"><a href="../../graph/differential-constraints/" title="差分约束" class="md-nav__link">差分约束</a><li class="md-nav__item"><a href="../../graph/kth-path/" title="k 短路" class="md-nav__link">k 短路</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-13" type="checkbox" id="nav-8-13"> <label class="md-nav__link" for="nav-8-13">连通性相关</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-8-13">连通性相关</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../graph/scc/" title="强连通分量" class="md-nav__link">强连通分量</a><li class="md-nav__item"><a href="../../graph/bcc/" title="双连通分量" class="md-nav__link">双连通分量</a><li class="md-nav__item"><a href="../../graph/bridge/" title="割点和桥" class="md-nav__link">割点和桥</a><li class="md-nav__item"><a href="../../graph/2-sat/" title="2-SAT" class="md-nav__link">2-SAT</a></ul></nav><li class="md-nav__item"><a href="../../graph/euler/" title="欧拉图" class="md-nav__link">欧拉图</a><li class="md-nav__item"><a href="../../graph/hamilton/" title="哈密顿图" class="md-nav__link">哈密顿图</a><li class="md-nav__item"><a href="../../graph/bi-graph/" title="二分图" class="md-nav__link">二分图</a><li class="md-nav__item"><a href="../../graph/min-circle/" title="最小环" class="md-nav__link">最小环</a><li class="md-nav__item"><a href="../../graph/planar/" title="平面图" class="md-nav__link">平面图</a><li class="md-nav__item"><a href="../../graph/color/" title="图的着色" class="md-nav__link">图的着色</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-8-20" type="checkbox" id="nav-8-20"> <label class="md-nav__link" for="nav-8-20">网络流</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-8-20">网络流</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../graph/flow/" title="网络流简介" class="md-nav__link">网络流简介</a><li class="md-nav__item"><a href="../../graph/flow/node/" title="拆点" class="md-nav__link">拆点</a><li class="md-nav__item"><a href="../../graph/flow/max-flow/" title="最大流" class="md-nav__link">最大流</a><li class="md-nav__item"><a href="../../graph/flow/min-cut/" title="最小割" class="md-nav__link">最小割</a><li class="md-nav__item"><a href="../../graph/flow/min-cost/" title="费用流" class="md-nav__link">费用流</a><li class="md-nav__item"><a href="../../graph/flow/bound/" title="上下界网络流" class="md-nav__link">上下界网络流</a></ul></nav><li class="md-nav__item"><a href="../../graph/misc/" title="图论杂项" class="md-nav__link">图论杂项</a></ul></nav><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9"> <label class="md-nav__link" for="nav-9">计算几何</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-9">计算几何</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../../geometry/" title="计算几何部分简介" class="md-nav__link">计算几何部分简介</a><li class="md-nav__item"><a href="../../geometry/2d/" title="二维计算几何基础" class="md-nav__link">二维计算几何基础</a><li class="md-nav__item"><a href="../../geometry/3d/" title="三维计算几何基础" class="md-nav__link">三维计算几何基础</a><li class="md-nav__item"><a href="../../geometry/distance/" title="距离" class="md-nav__link">距离</a><li class="md-nav__item"><a href="../../geometry/pick/" title="Pick 定理" class="md-nav__link">Pick 定理</a><li class="md-nav__item"><a href="../../geometry/triangulation/" title="三角剖分" class="md-nav__link">三角剖分</a><li class="md-nav__item"><a href="../../geometry/convex-hull/" title="凸包" class="md-nav__link">凸包</a><li class="md-nav__item"><a href="../../geometry/scanning/" title="扫描线" class="md-nav__link">扫描线</a><li class="md-nav__item"><a href="../../geometry/rotating-calipers/" title="旋转卡壳" class="md-nav__link">旋转卡壳</a><li class="md-nav__item"><a href="../../geometry/half-plane-intersection/" title="半平面交" class="md-nav__link">半平面交</a><li class="md-nav__item"><a href="../../geometry/nearest-points/" title="平面最近点对" class="md-nav__link">平面最近点对</a><li class="md-nav__item"><a href="../../geometry/magic/" title="计算几何杂项" class="md-nav__link">计算几何杂项</a></ul></nav><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10" checked=""> <label class="md-nav__link" for="nav-10">杂项</label><nav class="md-nav" data-md-component="collapsible" data-md-level="1"><label class="md-nav__title" for="nav-10">杂项</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../" title="杂项简介" class="md-nav__link">杂项简介</a><li class="md-nav__item"><a href="../io/" title="读入、输出优化" class="md-nav__link">读入、输出优化</a><li class="md-nav__item"><a href="../complexity/" title="复杂度" class="md-nav__link">复杂度</a><li class="md-nav__item"><a href="../discrete/" title="离散化" class="md-nav__link">离散化</a><li class="md-nav__item md-nav__item--active md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-10-5" type="checkbox" id="nav-10-5" checked=""> <label class="md-nav__link" for="nav-10-5">离线算法</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-10-5">离线算法</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../offline/" title="离线算法简介" class="md-nav__link">离线算法简介</a><li class="md-nav__item"><a href="../cdq-divide/" title="CDQ 分治" class="md-nav__link">CDQ 分治</a><li class="md-nav__item md-nav__item--active"><input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc"> <label class="md-nav__link md-nav__link--active" for="__toc">整体二分</label> <a href="./" title="整体二分" class="md-nav__link md-nav__link--active">整体二分</a><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">目录</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="#_1" title="引子" class="md-nav__link">引子</a><li class="md-nav__item"><a href="#_2" title="思路" class="md-nav__link">思路</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#_3" title="代码" class="md-nav__link">代码</a><li class="md-nav__item"><a href="#_4" title="参考习题" class="md-nav__link">参考习题</a></ul></nav><li class="md-nav__item"><a href="#_5" title="参考资料" class="md-nav__link">参考资料</a><li class="md-nav__item"><a href="#__comments" title="评论" class="md-nav__link md-nav__link--active">评论</a></ul></nav><li class="md-nav__item"><a href="../mo-algo/" title="莫队算法" class="md-nav__link">莫队算法</a></ul></nav><li class="md-nav__item"><a href="../fractional-programming/" title="分数规划" class="md-nav__link">分数规划</a><li class="md-nav__item md-nav__item--nested"><input class="md-toggle md-nav__toggle" data-md-toggle="nav-10-7" type="checkbox" id="nav-10-7"> <label class="md-nav__link" for="nav-10-7">随机化</label><nav class="md-nav" data-md-component="collapsible" data-md-level="2"><label class="md-nav__title" for="nav-10-7">随机化</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="../random/" title="随机函数" class="md-nav__link">随机函数</a><li class="md-nav__item"><a href="../hill-climbing/" title="爬山算法" class="md-nav__link">爬山算法</a><li class="md-nav__item"><a href="../simulated-annealing/" title="模拟退火" class="md-nav__link">模拟退火</a><li class="md-nav__item"><a href="../random-incremental/" title="随机增量法" class="md-nav__link">随机增量法</a></ul></nav><li class="md-nav__item"><a href="../largest-matrix/" title="悬线法" class="md-nav__link">悬线法</a><li class="md-nav__item"><a href="../cc-basic/" title="计算理论基础" class="md-nav__link">计算理论基础</a><li class="md-nav__item"><a href="../endianness/" title="字节顺序" class="md-nav__link">字节顺序</a></ul></nav></ul></nav></div></div></div><div class="md-sidebar md-sidebar--secondary" data-md-component="toc"><div class="md-sidebar__scrollwrap"><div class="md-sidebar__inner"><nav class="md-nav md-nav--secondary"><label class="md-nav__title" for="__toc">目录</label><ul class="md-nav__list" data-md-scrollfix=""><li class="md-nav__item"><a href="#_1" title="引子" class="md-nav__link">引子</a><li class="md-nav__item"><a href="#_2" title="思路" class="md-nav__link">思路</a><nav class="md-nav"><ul class="md-nav__list"><li class="md-nav__item"><a href="#_3" title="代码" class="md-nav__link">代码</a><li class="md-nav__item"><a href="#_4" title="参考习题" class="md-nav__link">参考习题</a></ul></nav><li class="md-nav__item"><a href="#_5" title="参考资料" class="md-nav__link">参考资料</a><li class="md-nav__item"><a href="#__comments" title="评论" class="md-nav__link md-nav__link--active">评论</a></ul></nav></div></div></div><div class="md-content"><article class="md-content__inner md-typeset"><a href="https://github.com/24OI/OI-wiki/blob/master/docs/misc/parallel-binsearch.md" title="编辑此页" class="md-icon md-content__icon"></a><h1>整体二分</h1><blockquote class="page-time"></blockquote><h2 id="_1">引子<a class="headerlink" href="#_1" title="Permanent link">¶</a></h2><p>在信息学竞赛中，有一部分题可以使用二分的办法来解决。但是当这种题目有多次询问且每次询问我们对每个查询都直接二分，可能会收获一个 TLE 。这时候我们就会用到整体二分。整体二分的主体思路就是把多个查询一起解决。（所以这是一个离线算法）<blockquote><p>可以使用整体二分解决的题目需要满足以下性质：<ol><li><p>询问的答案具有可二分性<li><p><strong>修改对判定答案的贡献互相独立</strong>，修改之间互不影响效果<li><p>修改如果对判定答案有贡献，则贡献为一确定的与判定标准无关的值<li><p>贡献满足交换律，结合律，具有可加性<li><p>题目允许使用离线算法</ol><p>——许昊然《浅谈数据结构题几个非经典解法》</blockquote><h2 id="_2">思路<a class="headerlink" href="#_2" title="Permanent link">¶</a></h2><p>记 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.07ex" height="2.634ex" style="vertical-align:-.755ex" viewBox="0 -809.3 1752.2 1134.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-1-Title"><title id="MathJax-SVG-1-Title">[l,r]</title><defs aria-hidden="true"><path stroke-width="1" id="E1-MJMAIN-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path stroke-width="1" id="E1-MJMATHI-6C" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path stroke-width="1" id="E1-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="1" id="E1-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path><path stroke-width="1" id="E1-MJMAIN-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"><use xlink:href="#E1-MJMAIN-5B" x="0" y="0"></use><use xlink:href="#E1-MJMATHI-6C" x="278" y="0"></use><use xlink:href="#E1-MJMAIN-2C" x="577" y="0"></use><use xlink:href="#E1-MJMATHI-72" x="1022" y="0"></use><use xlink:href="#E1-MJMAIN-5D" x="1473" y="0"></use></g></svg></span></span>为答案的值域，<span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.674ex" height="2.634ex" style="vertical-align:-.755ex" viewBox="0 -809.3 2443.2 1134.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-2-Title"><title id="MathJax-SVG-2-Title">[L,R]</title><defs aria-hidden="true"><path stroke-width="1" id="E2-MJMAIN-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path stroke-width="1" id="E2-MJMATHI-4C" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path stroke-width="1" id="E2-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="1" id="E2-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path stroke-width="1" id="E2-MJMAIN-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"><use xlink:href="#E2-MJMAIN-5B" x="0" y="0"></use><use xlink:href="#E2-MJMATHI-4C" x="278" y="0"></use><use xlink:href="#E2-MJMAIN-2C" x="960" y="0"></use><use xlink:href="#E2-MJMATHI-52" x="1405" y="0"></use><use xlink:href="#E2-MJMAIN-5D" x="2164" y="0"></use></g></svg></span></span>为答案的定义域。（也就是说求答案时仅考虑下标在区间 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.674ex" height="2.634ex" style="vertical-align:-.755ex" viewBox="0 -809.3 2443.2 1134.2" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-3-Title"><title id="MathJax-SVG-3-Title">[L,R]</title><defs aria-hidden="true"><path stroke-width="1" id="E3-MJMAIN-5B" d="M118 -250V750H255V710H158V-210H255V-250H118Z"></path><path stroke-width="1" id="E3-MJMATHI-4C" d="M228 637Q194 637 192 641Q191 643 191 649Q191 673 202 682Q204 683 217 683Q271 680 344 680Q485 680 506 683H518Q524 677 524 674T522 656Q517 641 513 637H475Q406 636 394 628Q387 624 380 600T313 336Q297 271 279 198T252 88L243 52Q243 48 252 48T311 46H328Q360 46 379 47T428 54T478 72T522 106T564 161Q580 191 594 228T611 270Q616 273 628 273H641Q647 264 647 262T627 203T583 83T557 9Q555 4 553 3T537 0T494 -1Q483 -1 418 -1T294 0H116Q32 0 32 10Q32 17 34 24Q39 43 44 45Q48 46 59 46H65Q92 46 125 49Q139 52 144 61Q147 65 216 339T285 628Q285 635 228 637Z"></path><path stroke-width="1" id="E3-MJMAIN-2C" d="M78 35T78 60T94 103T137 121Q165 121 187 96T210 8Q210 -27 201 -60T180 -117T154 -158T130 -185T117 -194Q113 -194 104 -185T95 -172Q95 -168 106 -156T131 -126T157 -76T173 -3V9L172 8Q170 7 167 6T161 3T152 1T140 0Q113 0 96 17Z"></path><path stroke-width="1" id="E3-MJMATHI-52" d="M230 637Q203 637 198 638T193 649Q193 676 204 682Q206 683 378 683Q550 682 564 680Q620 672 658 652T712 606T733 563T739 529Q739 484 710 445T643 385T576 351T538 338L545 333Q612 295 612 223Q612 212 607 162T602 80V71Q602 53 603 43T614 25T640 16Q668 16 686 38T712 85Q717 99 720 102T735 105Q755 105 755 93Q755 75 731 36Q693 -21 641 -21H632Q571 -21 531 4T487 82Q487 109 502 166T517 239Q517 290 474 313Q459 320 449 321T378 323H309L277 193Q244 61 244 59Q244 55 245 54T252 50T269 48T302 46H333Q339 38 339 37T336 19Q332 6 326 0H311Q275 2 180 2Q146 2 117 2T71 2T50 1Q33 1 33 10Q33 12 36 24Q41 43 46 45Q50 46 61 46H67Q94 46 127 49Q141 52 146 61Q149 65 218 339T287 628Q287 635 230 637ZM630 554Q630 586 609 608T523 636Q521 636 500 636T462 637H440Q393 637 386 627Q385 624 352 494T319 361Q319 360 388 360Q466 361 492 367Q556 377 592 426Q608 449 619 486T630 554Z"></path><path stroke-width="1" id="E3-MJMAIN-5D" d="M22 710V750H159V-250H22V-210H119V710H22Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"><use xlink:href="#E3-MJMAIN-5B" x="0" y="0"></use><use xlink:href="#E3-MJMATHI-4C" x="278" y="0"></use><use xlink:href="#E3-MJMAIN-2C" x="960" y="0"></use><use xlink:href="#E3-MJMATHI-52" x="1405" y="0"></use><use xlink:href="#E3-MJMAIN-5D" x="2164" y="0"></use></g></svg></span></span>内的元素）<ul><li>我们首先把所有操作<strong>按顺序</strong>存入数组中，然后开始分治。<li>在每一层分治中，利用数据结构（常见的是树状数组）统计当前查询的答案和 mid 之间的关系。<li>根据查询出来的答案和 mid 间的关系（小于等于 mid 和大于 mid）将当前处理的操作序列分为 q1 和 q2 两份，并分别递归处理。<li>当 <span><span class="mjpage"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.84ex" height="2.009ex" style="vertical-align:-.255ex" viewBox="0 -755.5 2084.1 865.1" role="img" focusable="false" xmlns="http://www.w3.org/2000/svg" aria-labelledby="MathJax-SVG-4-Title"><title id="MathJax-SVG-4-Title">l=r</title><defs aria-hidden="true"><path stroke-width="1" id="E4-MJMATHI-6C" d="M117 59Q117 26 142 26Q179 26 205 131Q211 151 215 152Q217 153 225 153H229Q238 153 241 153T246 151T248 144Q247 138 245 128T234 90T214 43T183 6T137 -11Q101 -11 70 11T38 85Q38 97 39 102L104 360Q167 615 167 623Q167 626 166 628T162 632T157 634T149 635T141 636T132 637T122 637Q112 637 109 637T101 638T95 641T94 647Q94 649 96 661Q101 680 107 682T179 688Q194 689 213 690T243 693T254 694Q266 694 266 686Q266 675 193 386T118 83Q118 81 118 75T117 65V59Z"></path><path stroke-width="1" id="E4-MJMAIN-3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z"></path><path stroke-width="1" id="E4-MJMATHI-72" d="M21 287Q22 290 23 295T28 317T38 348T53 381T73 411T99 433T132 442Q161 442 183 430T214 408T225 388Q227 382 228 382T236 389Q284 441 347 441H350Q398 441 422 400Q430 381 430 363Q430 333 417 315T391 292T366 288Q346 288 334 299T322 328Q322 376 378 392Q356 405 342 405Q286 405 239 331Q229 315 224 298T190 165Q156 25 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 114 189T154 366Q154 405 128 405Q107 405 92 377T68 316T57 280Q55 278 41 278H27Q21 284 21 287Z"></path></defs><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)" aria-hidden="true"><use xlink:href="#E4-MJMATHI-6C" x="0" y="0"></use><use xlink:href="#E4-MJMAIN-3D" x="576" y="0"></use><use xlink:href="#E4-MJMATHI-72" x="1632" y="0"></use></g></svg></span></span>时，找到答案，记录答案并返回即可。</ul><h3 id="_3">代码<a class="headerlink" href="#_3" title="Permanent link">¶</a></h3><p>例题：<a href="http://acm.zju.edu.cn/onlinejudge/showProblem.do?problemCode=2112">「ZOJ2112」 Dynamic Rankings</a><details><summary>例题参考代码</summary><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78</pre></div><td class="code"><div class="codehilite"><pre><span></span><span class="cp">#include</span><span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;cstdio&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;algorithm&gt;</span><span class="cp"></span>
<span class="cp">#include</span><span class="cpf">&lt;cmath&gt;</span><span class="cp"></span>

<span class="k">const</span> <span class="kt">int</span> <span class="n">maxn</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="mf">7e4</span><span class="o">+</span><span class="mi">1000</span><span class="p">);</span>
<span class="k">const</span> <span class="kt">int</span> <span class="n">inf</span> <span class="o">=</span> <span class="p">(</span><span class="kt">int</span><span class="p">)(</span><span class="mf">1e9</span><span class="o">+</span><span class="mi">1000</span><span class="p">);</span>

<span class="k">struct</span> <span class="n">node</span><span class="p">{</span>
    <span class="kt">int</span> <span class="n">val</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">ty</span><span class="p">;</span>
<span class="p">}</span><span class="n">q</span><span class="p">[</span><span class="n">maxn</span><span class="p">],</span><span class="n">q1</span><span class="p">[</span><span class="n">maxn</span><span class="p">],</span><span class="n">q2</span><span class="p">[</span><span class="n">maxn</span><span class="p">];</span>
<span class="kt">int</span> <span class="n">n</span><span class="p">,</span><span class="n">m</span><span class="p">,</span><span class="n">a</span><span class="p">[</span><span class="n">maxn</span><span class="p">],</span><span class="n">t</span><span class="p">,</span><span class="n">cnt</span><span class="p">,</span><span class="n">c</span><span class="p">[</span><span class="n">maxn</span><span class="p">],</span><span class="n">ans</span><span class="p">[</span><span class="n">maxn</span><span class="p">];</span>
<span class="kt">void</span> <span class="nf">add</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">,</span><span class="kt">int</span> <span class="n">x</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(;</span><span class="n">pos</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">pos</span><span class="o">+=</span><span class="n">pos</span><span class="o">&amp;-</span><span class="n">pos</span><span class="p">){</span>
        <span class="n">c</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">+=</span><span class="n">x</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">return</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">query</span><span class="p">(</span><span class="kt">int</span> <span class="n">pos</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">anstot</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(;</span><span class="n">pos</span><span class="o">&gt;=</span><span class="mi">1</span><span class="p">;</span><span class="n">pos</span><span class="o">-=</span><span class="n">pos</span><span class="o">&amp;-</span><span class="n">pos</span><span class="p">){</span>
        <span class="n">anstot</span><span class="o">+=</span><span class="n">c</span><span class="p">[</span><span class="n">pos</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">anstot</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">solve</span><span class="p">(</span><span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="kt">int</span> <span class="n">r</span><span class="p">,</span><span class="kt">int</span> <span class="n">L</span><span class="p">,</span><span class="kt">int</span> <span class="n">R</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">&gt;</span><span class="n">r</span><span class="o">||</span><span class="n">L</span><span class="o">&gt;</span><span class="n">R</span><span class="p">)</span><span class="k">return</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">cnt1</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">cnt2</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">mid</span><span class="o">=</span><span class="p">(</span><span class="n">l</span><span class="o">+</span><span class="n">r</span><span class="p">)</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">;</span>
    <span class="k">if</span><span class="p">(</span><span class="n">l</span><span class="o">==</span><span class="n">r</span><span class="p">){</span>
        <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">L</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">R</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
            <span class="k">if</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ty</span><span class="p">){</span><span class="n">ans</span><span class="p">[</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pos</span><span class="p">]</span><span class="o">=</span><span class="n">l</span><span class="p">;}</span>
        <span class="p">}</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="n">L</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">R</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span> <span class="c1">// 遍历下标在 [L, R] 区间内的所有询问</span>
        <span class="k">if</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ty</span><span class="p">){</span> <span class="c1">// 若当前处理的操作为查询操作</span>
            <span class="kt">int</span> <span class="n">tmp</span><span class="o">=</span><span class="n">query</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">y</span><span class="p">)</span><span class="o">-</span><span class="n">query</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">x</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span> <span class="c1">//值小于等于mid，且下标在[x,y]区间内的元素个数</span>
            <span class="k">if</span><span class="p">(</span><span class="n">tmp</span><span class="o">&gt;=</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">k</span><span class="p">)</span><span class="c1">//mid过大</span>
                <span class="n">q1</span><span class="p">[</span><span class="o">++</span><span class="n">cnt1</span><span class="p">]</span><span class="o">=</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
            <span class="k">else</span>
                <span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">k</span><span class="o">-=</span><span class="n">tmp</span><span class="p">,</span><span class="n">q2</span><span class="p">[</span><span class="o">++</span><span class="n">cnt2</span><span class="p">]</span><span class="o">=</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="k">if</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">val</span><span class="o">&lt;=</span><span class="n">mid</span><span class="p">){</span><span class="n">add</span><span class="p">(</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pos</span><span class="p">,</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">k</span><span class="p">);</span><span class="n">q1</span><span class="p">[</span><span class="o">++</span><span class="n">cnt1</span><span class="p">]</span><span class="o">=</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">];}</span>
            <span class="k">else</span> <span class="n">q2</span><span class="p">[</span><span class="o">++</span><span class="n">cnt2</span><span class="p">]</span><span class="o">=</span><span class="n">q</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
        <span class="p">}</span>

    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">cnt1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">q1</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ty</span><span class="p">)</span><span class="n">add</span><span class="p">(</span><span class="n">q1</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">pos</span><span class="p">,</span><span class="o">-</span><span class="n">q1</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">k</span><span class="p">);}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">cnt1</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="n">q</span><span class="p">[</span><span class="n">L</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">q1</span><span class="p">[</span><span class="n">i</span><span class="p">];}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">cnt2</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="n">q</span><span class="p">[</span><span class="n">L</span><span class="o">+</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="n">cnt1</span><span class="p">]</span><span class="o">=</span><span class="n">q2</span><span class="p">[</span><span class="n">i</span><span class="p">];}</span>
    <span class="n">solve</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="n">mid</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">L</span><span class="o">+</span><span class="n">cnt1</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span><span class="n">solve</span><span class="p">(</span><span class="n">mid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">L</span><span class="o">+</span><span class="n">cnt1</span><span class="p">,</span><span class="n">R</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">solve1</span><span class="p">(){</span>
    <span class="kt">int</span> <span class="n">cnt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">cntans</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="n">x</span><span class="p">;</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">n</span><span class="p">,</span><span class="o">&amp;</span><span class="n">m</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">n</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span><span class="n">q</span><span class="p">[</span><span class="o">++</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">node</span><span class="p">){</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
    <span class="p">}</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">m</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
        <span class="kt">int</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">k</span><span class="p">;</span><span class="kt">char</span> <span class="n">s</span><span class="p">[</span><span class="mi">5</span><span class="p">];</span><span class="n">scanf</span><span class="p">(</span><span class="s">"%s"</span><span class="p">,</span><span class="n">s</span><span class="p">);</span>
        <span class="k">if</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">==</span><span class="sc">'Q'</span><span class="p">){</span>
            <span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">l</span><span class="p">,</span><span class="o">&amp;</span><span class="n">r</span><span class="p">,</span><span class="o">&amp;</span><span class="n">k</span><span class="p">);</span><span class="n">q</span><span class="p">[</span><span class="o">++</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">node</span><span class="p">){</span><span class="mi">0</span><span class="p">,</span><span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="o">++</span><span class="n">cntans</span><span class="p">,</span><span class="mi">1</span><span class="p">};</span>
        <span class="p">}</span>
        <span class="k">else</span><span class="p">{</span>
            <span class="n">scanf</span><span class="p">(</span><span class="s">"%d%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">pos</span><span class="p">,</span><span class="o">&amp;</span><span class="n">x</span><span class="p">);</span><span class="n">q</span><span class="p">[</span><span class="o">++</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">node</span><span class="p">){</span><span class="n">a</span><span class="p">[</span><span class="n">pos</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span><span class="n">q</span><span class="p">[</span><span class="o">++</span><span class="n">cnt</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">node</span><span class="p">){</span><span class="n">a</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span><span class="o">=</span><span class="n">x</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">pos</span><span class="p">,</span><span class="mi">0</span><span class="p">};</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">solve</span><span class="p">(</span><span class="o">-</span><span class="n">inf</span><span class="p">,</span><span class="n">inf</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">cnt</span><span class="p">);</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">i</span><span class="o">&lt;=</span><span class="n">cntans</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">)</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">"%d</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="n">ans</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="p">}</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">scanf</span><span class="p">(</span><span class="s">"%d"</span><span class="p">,</span><span class="o">&amp;</span><span class="n">t</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">t</span><span class="o">--</span><span class="p">)</span> <span class="n">solve1</span><span class="p">();</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></table></details><h3 id="_4">参考习题<a class="headerlink" href="#_4" title="Permanent link">¶</a></h3><p><a href="https://www.luogu.org/problemnew/show/P1527">「国家集训队」 矩阵乘法</a><p><a href="https://loj.ac/problem/2169">「POI2011 R3 Day2」流星 Meteors</a><h2 id="_5">参考资料<a class="headerlink" href="#_5" title="Permanent link">¶</a></h2><ul><li>许昊然《浅谈数据结构题几个非经典解法》</ul><hr><blockquote class="page-copyright"><span><i class="md-icon">build</i>本页面最近更新：</span><span class="facts_modified"></span>，<a class="edit_history">更新历史</a><br><span><i class="md-icon">edit</i>发现错误？想一起完善？ <a href="https://github.com/24OI/OI-wiki/blob/master/docs/misc/parallel-binsearch.md" title="编辑此页" class="page_edit_url">在 GitHub 上编辑此页！</a></span><br><span><i class="md-icon">people</i>本页面贡献者：</span><span class="page_contributors"></span><br><span><i class="md-icon">copyright</i>本页面的全部内容在 <strong><a href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh">CC BY-SA 4.0</a> 和 <a href="https://github.com/zTrix/sata-license">SATA</a></strong> 协议之条款下提供，附加条款亦可能应用</span></blockquote><h2 id="__comments" data-no-instant="">评论</h2><form id="gitalk-form" onsubmit="return!1" data-no-instant=""><div id="gitalk-container" data-no-instant=""></div></form><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script><script>const gitalk = new Gitalk({
    id: '整体二分',
    owner: 'OI-wiki',
    repo: 'gitment',
    admin: ['Ir1d', 'cjsoft', 'TrisolarisHD', 'Xeonacid'],
    clientID: 'd6a911c8fba0194626d4',
    clientSecret: '867ec7e13cc99b420bd147cbb62d5cfec271ba81',
    distractionFreeMode: false,
    pagerDirection: 'first'
  })
  gitalk.render('gitalk-container')</script></article></div></div></main><script src="https://cdn.jsdelivr.net/npm/instantclick@3/dist/instantclick.min.js" data-no-instant=""></script><script data-no-instant="">InstantClick.init(!0)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/data-tip@0.0.52/dist/data-tip.min.css"><script>function scrollFunction(){20<document.body.scrollTop||20<document.documentElement.scrollTop?document.getElementById("myBtn").style.display="block":document.getElementById("myBtn").style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}window.onscroll=function(){scrollFunction()}</script><button onclick="topFunction()" id="myBtn" class="data-tip-left" data-tip="回到顶部"><svg class="Zi Zi--BackToTop data-tip-left" data-tip="回到顶部" fill="currentColor" viewBox="0 0 24 24" width="24" height="24"><path d="M16.036 19.59a1 1 0 0 1-.997.995H9.032a.996.996 0 0 1-.997-.996v-7.005H5.03c-1.1 0-1.36-.633-.578-1.416L11.33 4.29a1.003 1.003 0 0 1 1.412 0l6.878 6.88c.782.78.523 1.415-.58 1.415h-3.004v7.005z"></path></svg></button><footer class="md-footer"><div class="md-footer-nav"><nav class="md-footer-nav__inner md-grid"><a href="../cdq-divide/" title="CDQ 分治" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev"><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-back md-footer-nav__button"></i></div><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">后退 </span>CDQ 分治</span></div></a><a href="../mo-algo/" title="莫队算法" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next"><div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span class="md-flex__ellipsis"><span class="md-footer-nav__direction">前进 </span>莫队算法</span></div><div class="md-flex__cell md-flex__cell--shrink"><i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i></div></a></nav></div><div class="md-footer-meta md-typeset"><div class="md-footer-meta__inner md-grid"><div class="md-footer-copyright"><div class="md-footer-copyright__highlight">Copyright © 2016 - 2019 OI Wiki Team</div>powered by <a href="https://www.mkdocs.org">MkDocs</a> and <a href="https://squidfunk.github.io/mkdocs-material/">Material for MkDocs</a></div><span style="float:right" class="build_date_utc"><a href="https://github.com/24OI/OI-wiki">最近更新：7488470, 2019-05-13</a></span><script>console.log(`%c OI Wiki %c 7488470 %c`,"background:#35495e ; padding: 1px; border-radius: 3px 0 0 3px;  color: #fff","background:#41b883 ; padding: 1px; border-radius: 0 3px 3px 0;  color: #fff","background:transparent");
          console.log('少年，恭喜你囍提彩蛋，linhua.org 将是下一代编程竞赛训练平台，如果您对此感兴趣，欢迎访问 https://join-us.linhua.org');</script></div></div></footer></div><script src="https://cdn.jsdelivr.net/npm/ah@1.5.0/application.bce3478d.js"></script><script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script><script src="https://cdn.jsdelivr.net/gh/ethantw/Han@3.3.0/dist/han.min.js"></script><script src="../../_static/js/extra.js?v=10"></script>